<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECOENG - Sistema Unificado</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2ecc71;
            --secondary: #3498db;
            --accent: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: var(--dark);
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: 600;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        .form-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.1);
        }

        .quick-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }

        .quick-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            background: white;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .quick-btn:hover {
            background: #f8fff9;
            border-color: var(--primary);
        }

        .quick-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), #27ae60);
            color: white;
            padding: 15px 30px;
            border: none;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        /* CRM Styles */
        .crm-container {
            width: 100%;
        }

        .filtros {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .filtros input, .filtros select {
            margin-bottom: 0;
        }

        .parceiros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .parceiro-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .parceiro-card:hover {
            transform: translateY(-5px);
        }

        .status-ativo { border-left: 4px solid #2ecc71; }
        .status-pendente { border-left: 4px solid #f39c12; }
        .status-inativo { border-left: 4px solid #e74c3c; }

        .parceiro-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .parceiro-tipo {
            background: #e0e0e0;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .parceiro-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #f8f9fa;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #7f8c8d;
        }

        @media (max-width: 768px) {
            .filtros {
                grid-template-columns: 1fr;
            }
            
            .parceiros-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß¥ ECOENG - Sistema Unificado</h1>
            <p>Gest√£o de Coletas e Parceiros</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="openTab('coleta')">üìä Registrar Coleta</button>
            <button class="tab" onclick="openTab('parceiros')">üë• Gest√£o de Parceiros</button>
        </div>

        <!-- ABA COLETA -->
        <div id="coleta" class="tab-content active">
            <div class="form-container">
                <h2>üìä Registrar Nova Coleta</h2>
                
                <form id="coletaForm" action="https://docs.google.com/forms/d/e/1FAIpQLSdwlg35TajlA2DxfYBO2pD8C88A1wtZtjoJdGcDllvf_N6X8w/formResponse" method="POST" target="hidden_iframe">
                    
                    <div class="form-group">
                        <label>üìç Local de Coleta *</label>
                        <input type="text" name="entry.1746654924" placeholder="Ex: Entrada do bloco B - UVA" required>
                    </div>

                    <div class="form-group">
                        <label>üì¶ Quantidade Aproximada *</label>
                        <div class="quick-options">
                            <button type="button" class="quick-btn" onclick="setQuantidade(15, this)">Pouco (1-20)</button>
                            <button type="button" class="quick-btn" onclick="setQuantidade(35, this)">M√©dio (21-50)</button>
                            <button type="button" class="quick-btn" onclick="setQuantidade(75, this)">Muito (51-100)</button>
                            <button type="button" class="quick-btn" onclick="setQuantidade(120, this)">Muit√≠ssimo (100+)</button>
                        </div>
                        <input type="number" id="quantidade" name="entry.1808466649" placeholder="Ou digite o n√∫mero exato" min="1" required>
                    </div>

                    <div class="form-group">
                        <label>üë§ Respons√°vel *</label>
                        <input type="text" name="entry.1228588528" placeholder="Seu nome" required>
                    </div>

                    <div class="form-group">
                        <label>üìù Observa√ß√µes</label>
                        <textarea name="entry.444444444" rows="3" placeholder="Alguma observa√ß√£o importante?"></textarea>
                    </div>

                    <button type="submit" class="btn">‚úÖ Registrar Coleta</button>
                </form>

                <div class="success-message" id="successMessage">
                    üéâ Coleta registrada com sucesso! Obrigado pela contribui√ß√£o!
                </div>
            </div>
        </div>

        <!-- ABA PARCEIROS -->
        <div id="parceiros" class="tab-content">
            <div class="crm-container">
                <h2>üë• Gest√£o de Parceiros</h2>
                
                <div class="filtros">
                    <div>
                        <label>üîç Buscar parceiro</label>
                        <input type="text" id="search" placeholder="Nome, email ou telefone...">
                    </div>
                    
                    <div>
                        <label>Status</label>
                        <select id="filter-status">
                            <option value="">Todos</option>
                            <option value="ativo">Ativo</option>
                            <option value="pendente">Pendente</option>
                            <option value="inativo">Inativo</option>
                        </select>
                    </div>
                    
                    <div>
                        <label>Tipo</label>
                        <select id="filter-tipo">
                            <option value="">Todos</option>
                            <option value="empresa">Empresa</option>
                            <option value="ong">ONG</option>
                            <option value="comunidade">Comunidade</option>
                            <option value="governo">Governo</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-secondary" onclick="abrirModalNovoParceiro()">‚ûï Novo Parceiro</button>
                </div>

                <div class="parceiros-grid" id="lista-parceiros">
                    <!-- Parceiros carregados via JavaScript -->
                </div>
            </div>
        </div>

        <!-- MODAL NOVO PARCEIRO -->
        <div id="modalParceiro" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚ûï Cadastrar Novo Parceiro</h2>
                    <button class="close-btn" onclick="fecharModal()">√ó</button>
                </div>
                
                <form id="parceiroForm">
                    <div class="form-group">
                        <label>Nome da Empresa/Organiza√ß√£o *</label>
                        <input type="text" id="parceiroNome" placeholder="Ex: Empresa ABC Sustent√°vel" required>
                    </div>

                    <div class="form-group">
                        <label>Tipo de Parceiro *</label>
                        <select id="parceiroTipo" required>
                            <option value="">Selecione...</option>
                            <option value="empresa">Empresa</option>
                            <option value="ong">ONG</option>
                            <option value="comunidade">Comunidade</option>
                            <option value="governo">Governo</option>
                            <option value="educacao">Institui√ß√£o de Ensino</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Pessoa de Contato *</label>
                        <input type="text" id="parceiroContato" placeholder="Nome do respons√°vel" required>
                    </div>

                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="parceiroEmail" placeholder="email@exemplo.com" required>
                    </div>

                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="tel" id="parceiroTelefone" placeholder="(21) 99999-9999">
                    </div>

                    <div class="form-group">
                        <label>Status *</label>
                        <select id="parceiroStatus" required>
                            <option value="ativo">Ativo</option>
                            <option value="pendente">Pendente</option>
                            <option value="inativo">Inativo</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Contribui√ß√£o *</label>
                        <textarea id="parceiroContribuicao" rows="3" placeholder="Ex: Pontos de coleta, recursos financeiros, volunt√°rios..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Observa√ß√µes</label>
                        <textarea id="parceiroObservacoes" rows="2" placeholder="Informa√ß√µes adicionais..."></textarea>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button type="button" class="btn" onclick="salvarParceiro()">üíæ Salvar Parceiro</button>
                        <button type="button" class="btn btn-secondary" onclick="fecharModal()">‚ùå Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Iframe oculto para envio do formul√°rio -->
        <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>
    </div>

    <script>
        // Dados dos parceiros (em produ√ß√£o, viria de uma API/Google Sheets)
        let parceiros = [
            {
                id: 1,
                nome: "Empresa ABC Sustent√°vel",
                tipo: "empresa",
                contato: "Maria Silva",
                email: "maria@empresaabc.com",
                telefone: "(21) 99999-9999",
                status: "ativo",
                dataCadastro: "15/09/2025",
                contribuicao: "Pontos de coleta + recursos"
            },
            {
                id: 2,
                nome: "ONG Verde Vida",
                tipo: "ong", 
                contato: "Jo√£o Santos",
                email: "joao@verdevida.org",
                telefone: "(21) 98888-8888",
                status: "ativo",
                dataCadastro: "20/09/2025",
                contribuicao: "Volunt√°rios + divulga√ß√£o"
            },
            {
                id: 3,
                nome: "Comunidade Catete",
                tipo: "comunidade",
                contato: "Pedro Oliveira",
                email: "pedro.catete@gmail.com",
                telefone: "(21) 97777-7777",
                status: "pendente",
                dataCadastro: "25/09/2025",
                contribuicao: "Mobiliza√ß√£o local"
            }
        ];

        // Sistema de Abas
        function openTab(tabName) {
            // Esconder todas as abas
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remover active de todas as tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            
            // Ativar tab selecionada
            event.currentTarget.classList.add('active');
            
            // Se for a aba de parceiros, carregar a lista
            if (tabName === 'parceiros') {
                carregarParceiros();
            }
        }

        // Sistema de Coleta
        let activeQuickBtn = null;

        function setQuantidade(valor, button) {
            document.getElementById('quantidade').value = valor;
            
            // Remove classe active de todos os bot√µes
            document.querySelectorAll('.quick-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Adiciona classe active ao bot√£o clicado
            if (button) {
                button.classList.add('active');
                activeQuickBtn = button;
            }
        }

        // Envio do formul√°rio de coleta
        document.getElementById('coletaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Mostrar mensagem de sucesso
            document.getElementById('successMessage').style.display = 'block';
            
            // Resetar formul√°rio ap√≥s 3 segundos
            setTimeout(function() {
                document.getElementById('coletaForm').reset();
                document.getElementById('successMessage').style.display = 'none';
                if (activeQuickBtn) {
                    activeQuickBtn.classList.remove('active');
                    activeQuickBtn = null;
                }
            }, 3000);

            // Enviar formul√°rio para o Google Forms
            const formData = new FormData(this);
            fetch(this.action, {
                method: 'POST',
                body: formData,
                mode: 'no-cors'
            });
        });

        // Sistema de Parceiros (CRM)
        function carregarParceiros() {
            const container = document.getElementById('lista-parceiros');
            const searchTerm = document.getElementById('search').value.toLowerCase();
            const statusFilter = document.getElementById('filter-status').value;
            const tipoFilter = document.getElementById('filter-tipo').value;
            
            container.innerHTML = '';
            
            const parceirosFiltrados = parceiros.filter(parceiro => {
                const matchSearch = 
                    parceiro.nome.toLowerCase().includes(searchTerm) ||
                    parceiro.contato.toLowerCase().includes(searchTerm) ||
                    parceiro.email.toLowerCase().includes(searchTerm) ||
                    parceiro.telefone.includes(searchTerm);
                
                const matchStatus = !statusFilter || parceiro.status === statusFilter;
                const matchTipo = !tipoFilter || parceiro.tipo === tipoFilter;
                
                return matchSearch && matchStatus && matchTipo;
            });
            
            if (parceirosFiltrados.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #7f8c8d; grid-column: 1 / -1;">Nenhum parceiro encontrado com os filtros selecionados.</p>';
                return;
            }
            
            parceirosFiltrados.forEach(parceiro => {
                const card = document.createElement('div');
                card.className = `parceiro-card status-${parceiro.status}`;
                card.innerHTML = `
                    <div class="parceiro-header">
                        <h3 style="flex: 1;">${parceiro.nome}</h3>
                        <span class="parceiro-tipo">${parceiro.tipo}</span>
                    </div>
                    <p><strong>Contato:</strong> ${parceiro.contato}</p>
                    <p><strong>Email:</strong> ${parceiro.email}</p>
                    <p><strong>Telefone:</strong> ${parceiro.telefone}</p>
                    <p><strong>Contribui√ß√£o:</strong> ${parceiro.contribuicao}</p>
                    <p><strong>Status:</strong> ${parceiro.status}</p>
                    <p><strong>Desde:</strong> ${parceiro.dataCadastro}</p>
                    <div class="parceiro-actions">
                        <button class="action-btn" onclick="editarParceiro(${parceiro.id})">‚úèÔ∏è Editar</button>
                        <button class="action-btn" onclick="verHistorico(${parceiro.id})">üìä Hist√≥rico</button>
                        <button class="action-btn" onclick="exportarContato(${parceiro.id})">üìû Contatar</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Modal de Novo Parceiro
        function abrirModalNovoParceiro() {
            document.getElementById('modalParceiro').style.display = 'flex';
            document.getElementById('parceiroForm').reset();
        }

        function fecharModal() {
            document.getElementById('modalParceiro').style.display = 'none';
        }

        function salvarParceiro() {
            const novoParceiro = {
                id: parceiros.length + 1,
                nome: document.getElementById('parceiroNome').value,
                tipo: document.getElementById('parceiroTipo').value,
                contato: document.getElementById('parceiroContato').value,
                email: document.getElementById('parceiroEmail').value,
                telefone: document.getElementById('parceiroTelefone').value,
                status: document.getElementById('parceiroStatus').value,
                dataCadastro: new Date().toLocaleDateString('pt-BR'),
                contribuicao: document.getElementById('parceiroContribuicao').value
            };

            // Validar campos obrigat√≥rios
            if (!novoParceiro.nome || !novoParceiro.tipo || !novoParceiro.contato || !novoParceiro.email || !novoParceiro.contribuicao) {
                alert('Por favor, preencha todos os campos obrigat√≥rios!');
                return;
            }

            // Adicionar √† lista
            parceiros.push(novoParceiro);
            
            // Fechar modal e recarregar lista
            fecharModal();
            carregarParceiros();
            
            // Mostrar mensagem de sucesso
            alert('üéâ Parceiro cadastrado com sucesso!');
        }

        function editarParceiro(id) {
            const parceiro = parceiros.find(p => p.id === id);
            if (parceiro) {
                // Preencher modal com dados existentes
                document.getElementById('parceiroNome').value = parceiro.nome;
                document.getElementById('parceiroTipo').value = parceiro.tipo;
                document.getElementById('parceiroContato').value = parceiro.contato;
                document.getElementById('parceiroEmail').value = parceiro.email;
                document.getElementById('parceiroTelefone').value = parceiro.telefone;
                document.getElementById('parceiroStatus').value = parceiro.status;
                document.getElementById('parceiroContribuicao').value = parceiro.contribuicao;
                
                // Abrir modal
                document.getElementById('modalParceiro').style.display = 'flex';
                
                // Alterar comportamento do bot√£o salvar para edi√ß√£o
                document.querySelector('.modal-header h2').textContent = '‚úèÔ∏è Editar Parceiro';
                document.querySelector('.modal-content .btn').onclick = function() { atualizarParceiro(id); };
            }
        }

        function atualizarParceiro(id) {
            const index = parceiros.findIndex(p => p.id === id);
            if (index !== -1) {
                parceiros[index] = {
                    ...parceiros[index],
                    nome: document.getElementById('parceiroNome').value,
                    tipo: document.getElementById('parceiroTipo').value,
                    contato: document.getElementById('parceiroContato').value,
                    email: document.getElementById('parceiroEmail').value,
                    telefone: document.getElementById('parceiroTelefone').value,
                    status: document.getElementById('parceiroStatus').value,
                    contribuicao: document.getElementById('parceiroContribuicao').value
                };

                fecharModal();
                carregarParceiros();
                alert('‚úÖ Parceiro atualizado com sucesso!');
            }
        }

        function verHistorico(id) {
            alert(`üìä Visualizando hist√≥rico do parceiro ID: ${id}\n\nFuncionalidade em desenvolvimento.`);
        }

        function exportarContato(id) {
            const parceiro = parceiros.find(p => p.id === id);
            if (parceiro) {
                const vcard = `BEGIN:VCARD
VERSION:3.0
FN:${parceiro.contato}
ORG:${parceiro.nome}
EMAIL:${parceiro.email}
TEL:${parceiro.telefone}
END:VCARD`;
                
                const blob = new Blob([vcard], { type: 'text/vcard' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${parceiro.contato}.vcf`;
                a.click();
            }
        }

        // Filtros em tempo real
        document.getElementById('search').addEventListener('input', carregarParceiros);
        document.getElementById('filter-status').addEventListener('change', carregarParceiros);
        document.getElementById('filter-tipo').addEventListener('change', carregarParceiros);

        // Fechar modal ao clicar fora
        document.getElementById('modalParceiro').addEventListener('click', function(e) {
            if (e.target === this) {
                fecharModal();
            }
        });

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            carregarParceiros();
        });
    </script>
</body>
</html>
